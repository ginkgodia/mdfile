**Wireshark抓包诊断TCP连接**



**TCP的状态**

(SYN, FIN , ACK ,PSH ,RST, URG)

```
SYN :表示建立连接
FIN :表示建立连接
ACK :表示响应
PSH :表示有data数据传输，一般表示为分片数据的传输，用于快速传递数据
RST :表示连接重置，用来关闭异常的连接
其中，ACK有可能和SYN，FIN，同时使用，比如： SYN和ACK 同时为1 ，表示连接建立之后的响应
SYN和FIN不会同时为1，因为SYN表示建立连接，而FIN表示重置连接
RST一般是在FIN之后才会出现1的情况
一般地，当FIN或者RST出现时，我们便认为客户端和服务器断开了链接
当出现SYN和SYN+ACK包时，我们认为客户端和服务器建立了连接

```

- 出现RST的原因：

```
1. 端口未打开
服务器程序端口未打开而客户端来连接，但在某些主机如果请求不存在的端口，则不响应
2. 请求超时
3. 提前关闭
由于"TCP是一种可靠的链接" ，那么操作系统收到的来自TCP中的每一个字节，都会让应用程序收到，但是如果应用程序不接受怎么办？ RST
4. 在一个已经关闭的socket上接受数据
```

- TCP的常见字段

```
RTO:重新发送超时时间，retransmissino timeout
RTT:往返时间，round trip time
Win:
MSS
WS
Seq: 数据段的序号，当TCP收到乱序报文时，可提供重新排序
```

