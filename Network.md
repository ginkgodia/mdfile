**TCPdump**



- Tcpdump保存与读取文件

  ```
  tcpdump -l |tee out.file :  来在屏幕上输出的同时保存的文件中
  tcpdump -w out.cap : 直接将截获内容保存到指定文件，不允许直接读取
  tcpdump -r out.cap : 直接读取之前保存的抓包文件
  tcpdump -r rawfile > textfile : 将raw文件转换成text文件

  ```

- Tcpdump的选项

```
- 控制tcpdump程序行为
- 控制数据怎样显示
- 控制显示什么数据
- 过滤命令
```

**控制程序行为**

```
-c :指定收集报文的数量，如果用户知道需要捕获的报文数量或者报文数量上限，使用-c选项可在收集到	 多少个报文后自动停止，不需要手动停止
	tcpdump -c100
	
-i :指定网络接口，如果不指定，默认使用最低编号接口

-p :设置网卡接口为非混杂模式

-s :控制数据的截取长度，通常，tcpdump默认截取一最大字节数量，并且只会从单一报文中截取到该数		量的长度，实际字节数有操作系统设备的驱动决定。通过默认值来截取合适的报文头，而舍弃不需要	的报文数据。如果需要截取更多的报文，用-s指定

```

**控制信息如何显示**

```
-a ：尝试将网络地址显示为名称
-n : 不将主机地址转换为名字
-N : 不输出域全名
-f ：阻止远端名称解析
-t : 不显示时间戳
-tt:显示无格式的时间戳
-l ：使用标准输出列的缓冲区
```

**控制显示什么数据**

```
-v : 显示更多详细信息 ， -v会显示打印TTL字段
-q : 显示较少信息
-e : 显示链路层头部信息

```

**过滤信息**

```
为了筛选到我们需要的信息，需要使用过滤器
对于简单的过滤，我们可以直接在命令行后加关键字
对于复杂的信息，我们可以将过滤器写在文件中，使用 -F 参数指定过滤器，执行过滤操作
命令行和文件过滤器不能混用

- 地址过滤： 过滤器按照地址选取数据
  tcpdump -c10 host 19.23.41.1
  注意： 虽然指定的是IP地址，但抓取的数据流并不限于IP数据流，实际上，过滤器也会抓取到ARP数据流，限定仅抓取特定协议的数据流需要更复杂的过滤器
  tcpdump -c10 ether host MAC地址  通过mac地址抓取
  
 - 协议和端口过滤：限制抓取指定协议，IP
```

